## 3.1 ì»¨í…Œì´ë„ˆ ì„œë¹„ìŠ¤

### 3.1.1 ì»¨í…Œì´ë„ˆ ì„œë¹„ìŠ¤ë€?

- ì»¨í…Œì´ë„ˆì˜ ì‚¬ì „ì  ì˜ë¯¸: ì–´ë–¤ ì‚¬ë¬¼ì„ ê²©ë¦¬í•  ìˆ˜ ìˆëŠ” ê³µê°„

  â†’ ìš°ë¦¬ê°€ ì„œë¹„ìŠ¤í•˜ê³ ì í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ, í”„ë¡œì„¸ìŠ¤ë¥¼ ê²©ë¦¬í•œë‹¤ëŠ” ì˜ë¯¸ë¡œì„œ ì»¨í…Œì´ë„ˆë¼ëŠ” ì›Œë”©ì„ í™œìš©!

- ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ í™˜ê²½ì´ ì»¨í…Œì´ë„ˆ ì„œë¹„ìŠ¤ í™˜ê²½ìœ¼ë¡œ ì „í™˜ëœ ì´ìœ ?
    - Pain point: ê°€ë³€ì  ì¸í”„ë¼ í™˜ê²½ìœ¼ë¡œ ì¸í•œ ì¼ê´€ì„± ì—†ëŠ” í™˜ê²½ ì œê³µ ë•Œë¬¸!
        - ê°œë°œ, í…ŒìŠ¤íŠ¸, ë°°í¬, ìš´ì˜ì˜ ì»´í“¨íŒ… í™˜ê²½ ì°¨ì´ë¡œ ì¸í•œ ì‹œí–‰ì°©ì˜¤ & ë‹¤ì–‘í•œ ì˜¤ë¥˜ í•´ê²°ì— ë„ˆë¬´ ë§ì€ ì‹œê°„ì„ ìŸëŠ”ë‹¤..!
- ì»¨í…Œì´ë„ˆ ì„œë¹„ìŠ¤: ë…¼ë¦¬ì  íŒ¨í‚¤ì§• ë§¤ì»¤ë‹ˆì¦˜ ì œê³µ
    - ì• í”Œë¦¬ì¼€ì´ì…˜ì— í•„ìš”í•œ ë°”ì´ë„ˆë¦¬, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° êµ¬ì„± íŒ¡ë¦¬ ë“±ì„ íŒ¨í‚¤ì§€ë¡œ ë¬¶ì–´ ë°°í¬

### 3.1.2 ì™œ ë„ì»¤ ì»¨í…Œì´ë„ˆ ì„œë¹„ìŠ¤ì¼ê¹Œ?

- ë„ì»¤ë¥¼ ì´ìš©í•œ ì»¨í…Œì´ë„ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ ê°œë°œ ê³¼ì •
    1. ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ê°œë°œ
        - íŠ¹ì • ì„œë¹„ìŠ¤ êµ¬ë™ì„ ìœ„í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ë° ì›¹ í™”ë©´ êµ¬ì„± ë“±ì„ ìœ„í•œ ì½”ë“œ ê°œë°œ
    2. ë² ì´ìŠ¤ ì´ë¯¸ì§€ë¥¼ ì´ìš©í•œ Dockerfile ì‘ì„±
        - ê°œë°œì— í•„ìš”í•œ ì¸í”„ë¼ êµ¬ì„± ìš”ì†Œë¥¼ Dockerfileì— ì‘ì„±.
        - ë„ì»¤ í—ˆë¸Œë¥¼ í†µí•´ ë² ì´ìŠ¤ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ë‹¤ì–‘í•œ êµ¬ë™ ëª…ë ¹ì–´ì™€ 1ì—ì„œ ì‘ì„±í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“±ì„ Dockerfileì— í¬í•¨ì‹œí‚¨ë‹¤.
    3. Dockerfile buildë¥¼ í†µí•œ ìƒˆë¡œìš´ ì´ë¯¸ì§€ ìƒì„±
        - docker build ëª…ë ¹ì„ í†µí•´ ì‘ì„±í•œ Dockerfileì„ ì‹¤í–‰. ê° ë‹¨ê³„ë³„ë¡œ ì‹¤í–‰ë˜ëŠ” ë¡œê·¸ë¥¼ í™”ë©´ì—ì„œ í™•ì¸í•˜ë©° ì´ë•Œ ì˜¤ë¥˜ ë°œìƒ ë‚´ìš©ë„ í™•ì¸.
    4. ì»¨í…Œì´ë„ˆ ì‹¤í–‰
        1. ìƒì„±ëœ ì´ë¯¸ì§€ë¥¼ ì´ìš©í•œ ì»¨í…Œì´ë„ˆ ìƒì„±
            - ë„ì»¤ ëª…ë ¹ì–´ docker imagesë¥¼ í†µí•´ ìƒì„±ëœ ì´ë¯¸ì§€ë¥¼ í™•ì¸í•˜ê³  ì´ë¯¸ì§€ë¥¼ í†µí•œ ì»¨í…Œì´ë„ˆë¥¼ êµ¬ë™(`docker run`)í•œë‹¤.
        2. ë„ì»¤ ì»´í¬ì¦ˆë¥¼ ì´ìš©í•œ ë‹¤ì¤‘ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
            - ë„ì»¤ ì‹¤í–‰ ì˜µì…˜ì„ ë¯¸ë¦¬ ì‘ì„±í•œ docker-compose.ymlì„ í†µí•´ ë‹¤ì¤‘ ì»¨í…Œì´ë„ˆê°„ ì‹¤í–‰ ìˆœì„œ, ë„¤íŠ¸ì›Œí¬, ì˜ì¡´ì„± ë“±ì„ í†µí•© ê´€ë¦¬í•  ìˆ˜ ìˆê³  ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°œë°œì— í™œìš©.
    5. ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸
        1. ì»¨í…Œì´ë„ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸
            - ex) Nginxë¥¼ ì´ìš©í•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…Œì´ë„ˆ ì„œë¹„ìŠ¤ì˜€ë‹¤ë©´ ì—°ê²°í•˜ëŠ” IPì™€ í¬íŠ¸ ë²ˆí˜¸ë¥¼ ì´ìš©í•´ ì›¹ ë¸Œë¼ìš°ì €ë¥¼ ì´ìš©í•œ í˜ì´ì§€ ì—°ê²° í™•ì¸
        2. ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸
            - í•´ë‹¹ ì„œë¹„ìŠ¤ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ì§„í–‰
    6. ë¡œì»¬ ë° ì›ê²© ì €ì¥ì†Œì— ì´ë¯¸ì§€ ì €ì¥(push)
        - ë¡œì»¬ ë° ì›ê²©ì— ìˆëŠ” ì´ë¯¸ì§€ ì €ì¥ì†Œì— ìƒì„±í•œ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•´ ë‹¤ë¥¸ íŒ€ ê°„ì˜ ê³µìœ  ë° ì§€ì†ì ì¸ ì´ë¯¸ì§€ ê´€ë¦¬ ìˆ˜í–‰
    7. ê¹ƒí—ˆë¸Œ ë“±ì„ í™œìš©í•œ  Dockerfile ê´€ë¦¬
        - Dockerfile ì½”ë“œë¥¼ ê¹ƒí—ˆë¸Œ ì‚¬ì´íŠ¸ì— ì €ì¥ ë° ê´€ë¦¬í•  ìˆ˜ ìˆê³ , ë„ì»¤ í—ˆë¸Œ ì‚¬ì´íŠ¸ì™€ ì—°ë™í•˜ê²Œ ë˜ë©´ ìë™í™”ëœ ë¹Œë“œ ê¸°ëŠ¥ì„ ì´ìš©í•œ ì´ë¯¸ì§€ ìƒì„±ë„ ê°€ëŠ¥
    8. ë™ì¼ í™˜ê²½ì—ì„œì˜ ì§€ì†ì  ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ ìˆ˜í–‰
        - 1~7 ê³¼ì •ì„ í†µí•´ ì—…ë¬´ìš© ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¯¸ì§€ë¥¼ ì§€ì†ì ìœ¼ë¡œ ê°œë°œ, ìš´ì˜ ë° ê´€ë¦¬í•  ìˆ˜ ìˆìŒ.
- ë„ì»¤ ì‘ë™ì—ì„œ ëˆˆì—¬ê²¨ë³¼ ê²ƒ: ì»¨í…Œì´ë„ˆ ë™ì‘ì— í•„ìš”í•œ ëª¨ë“  ë‚´ìš©ì„ ì‚¬ì „ì— ì½”ë“œë¡œ ì‘ì„±í•´ ìë™í™” â†’ IaC

## 3.2 ë„ì»¤ ëª…ë ¹ì–´ í™œìš©

### 3.2.1 ë„ì»¤ ì´ë¯¸ì§€ ëª…ë ¹ì–´

- ë„ì»¤ ì»¨í…Œì´ë„ˆ: ë„ì»¤ í—ˆë¸Œì—ì„œ ì œê³µí•˜ëŠ” ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹¤í–‰
- ë„ì»¤ ì´ë¯¸ì§€: ë„ì»¤ì˜ í•µì‹¬ ê¸°ìˆ  â†’ ì½”ë“œë¡œ ê°œë°œëœ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ í™˜ê²½ ì •ë³´(ë°”ì´ë„ˆë¦¬, ë¼ì´ë¸ŒëŸ¬ë¦¬, ê°ì¢… ë„êµ¬ ë“±)ë¥¼ ê³ ìŠ¤ë€íˆ ë³µì œí•´ì„œ ì‚¬ìš© ê°€ëŠ¥
- ë„ì»¤ ì»¨í…Œì´ë„ˆë¡œ ì‚¬ìš©í•  ë„ì»¤ ì´ë¯¸ì§€: docker searchë¥¼ í†µí•´ ì¡°íšŒ â†’ ë„ì»¤ í—ˆë¸Œ & ê°œì¸ ì‚¬ìš©ìë“¤ì´ ê³µê°œí•œ ê´€ë ¨ ì´ë¯¸ì§€ ì„œì¹˜ ê°€ëŠ¥
- ë¡œì»¬ ì„œë²„ & ë°ìŠ¤í¬í†±ì— ë„ì»¤ ì´ë¯¸ì§€ ì €ì¥í•˜ë ¤ë©´
    - Dockerfileì„ í†µí•´ ìƒˆë¡œìš´ ì´ë¯¸ì§€ë¥¼ ìƒì„±: docker build
        - Dockerfileë¡œ ìƒì„±í•œ ì´ë¯¸ì§€ëŠ” ë„ì»¤ í—ˆë¸Œì— ì—…ë¡œë“œ ê°€ëŠ¥(docker push)
    - ë„ì»¤ í—ˆë¸Œë¡œë¶€í„° ì´ë¯¸ì§€ë¥¼ ë‚´ë ¤ë°›ê¸°: docker pull

**ë„ì»¤ ì´ë¯¸ì§€ ë‚´ë ¤ë°›ê¸°**

- ë„ì»¤ í—ˆë¸Œ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¡œë¶€í„° ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë‚´ë ¤ë°›ê±°ë‚˜ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì—…ë¡œë“œí•˜ëŠ” ê³¼ì •ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ì•„ë˜ì˜ ëª…ë ¹ ì‚¬ìš©
    - docker pull: ë„ì»¤ í—ˆë¸Œ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ë¡œì»¬ë¡œ ë„ì»¤ ì´ë¯¸ì§€ ë‚´ë ¤ë°›ê¸°
        - docker pull ëª…ë ¹ì„ ì´ìš©í•  ë•Œ ì˜µì…˜ & íƒœê·¸ ë“±ìœ¼ë¡œ ì„¸ë¶€ ì‚¬í•­ ì§€ì • ê°€ëŠ¥

          **`ì‹¤ìŠµ: debian ë‹¤ìš´ë¡œë“œ`**

          ![img.png](img.png)

            ```bash
            docker [image] pull [OPTIONS] name[:TAG | @IMAGE_DIGEST]
            
            1. Using default tag: latest
            2. latest: Pulling from library/debian
            3. 90fe46dd8199: Pull complete
            4. Digest: sha256: 281p2asdfnj123hiuhskjdf
            5. Status: Downloaded newer image for debian:latest
            6. docker.io/
            ```

            1. íƒœê·¸: ì´ë¯¸ì§€ ë’¤ì— íƒœê·¸ë¥¼ ë”°ë¡œ ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ ìµœì‹  ë²„ì „(latest)ìœ¼ë¡œ ë‹¤ìš´ë°›ëŠ”ë‹¤. íŠ¹ì • ë²„ì „ì„ ì§€ì •í•˜ë©´ latest ëŒ€ì‹  ì§€ì •í•œ ë²„ì „ëª…ì´ í¬í•¨ëœë‹¤.
            2. ë¼ì´ë¸ŒëŸ¬ë¦¬: ë„ì»¤ í—ˆë¸Œê°€ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ê³  ìˆëŠ” ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ ì œê³µ
            3. ë„ì»¤ í—ˆë¸Œì—ì„œ ì œê³µëœ ì´ë¯¸ì§€ì˜ ë¶„ì‚° í•´ì‹œ ê°’ í‘œì‹œ. ë‹¤ìš´ë¡œë“œí•œ ì´ë¯¸ì§€ëŠ” ì—¬ëŸ¬ ê³„ì¸µìœ¼ë¡œ ë§Œë“¤ì–´ì§€ëŠ”ë° ê·¸ì¤‘ ì´ë¯¸ì§€ í•µì‹¬ ì •ë³´ë¥¼ ë°”ì´ë„ˆë¦¬ í˜•íƒœì˜ ì •ë³´ë¡œ ì œê³µ
            4. ë‹¤ì´ì œìŠ¤íŠ¸ê°’: ì›ê²© ë„ì»¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬(ë„ì»¤ í—ˆë¸Œ)ì—ì„œ ê´€ë¦¬í•˜ëŠ” ì´ë¯¸ì§€ì˜ ê³ ìœ  ì‹ë³„ê°’
            5. ë‹¤ìš´ë¡œë“œ ì™„ë£Œ
            6. docker.io: ë„ì»¤ í—ˆë¸Œ ì´ë¯¸ì§€ ì €ì¥ì†Œ ì£¼ì†Œ
        - ë‹¤ìš´ë¡œë“œí•œ ì´ë¯¸ì§€ ì •ë³´ëŠ” docker image lsë¥¼ í†µí•´ ì¡°íšŒ ê°€ëŠ¥
    - docker push: ë¡œì»¬ì— ìˆëŠ” ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë„ì»¤ í—ˆë¸Œ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì—…ë¡œë“œ
    - docker login: ì—…ë¡œë“œë¥¼ í•˜ê¸° ì „ ë„ì»¤ í—ˆë¸Œ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ ìˆ˜í–‰í•˜ê¸°
    - docker logout: ë„ì»¤ í—ˆë¸Œì—ì„œ ë¡œê·¸ì•„ì›ƒí•˜ê¸°

**ë„ì»¤ ì´ë¯¸ì§€ ì„¸ë¶€ ì •ë³´ ì¡°íšŒ**

- ë„ì»¤ ì˜¤ë¸Œì íŠ¸ì— ëŒ€í•œ ì„¸ë¶€ ì •ë³´ ì¡°íšŒë¥¼ ìœ„í•´ docker image inspect, docker image history, ë¬¼ë¦¬ì ìœ¼ë¡œ í˜¸ìŠ¤íŠ¸ ìš´ì˜ì²´ì œì— ì €ì¥ëœ ì˜ì—­ì„ ì´ìš©í•˜ê¸° ë“±ì´ ìˆë‹¤.
    1. `docker inspect`: JSON ì–¸ì–´ í˜•íƒœë¡œ ì •ë³´ ì¶œë ¥ â†’ í¬ë§· ì˜µì…˜ì„ ì´ìš©í•´ ì›í•˜ëŠ” ì •ë³´ë§Œ ì¶œë ¥ ê°€ëŠ¥

        ```bash
        docker image inspect [OPTIONS] IMAGE [IMAGE...]
        ```

        - **`ì‹¤ìŠµ: ì•„íŒŒì¹˜ ì›¹ ì„œë¹„ìŠ¤ë¥¼ í•  ìˆ˜ ìˆëŠ” httpd ë„ì»¤ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ`**
            1. `docker search httpd`: ìˆ˜í–‰ ì „ hub.docker.comì— ê°€ì…í•œ ë³¸ì¸ ê³„ì •ìœ¼ë¡œ docker loginì„ ë¨¼ì € ìˆ˜í–‰í•˜ê³  ì¡°íšŒ(docker login ì´í›„ docker search ì‚¬ìš©)

               ![img_1.png](img_1.png)

            2. `docker pull httpd(:latest)`: httpd ìµœì‹  ë²„ì „ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ

               ![img_2.png](img_2.png)

            3. `docker images`: ë‹¤ìš´ë¡œë“œí•œ ì´ë¯¸ì§€ ì¡°íšŒ

               ![img_3.png](img_3.png)

            4. `docker image inspect httpd`: ë‹¤ìš´ë¡œë“œí•œ ì´ë¯¸ì§€ ì„¸ë¶€ ì •ë³´ ì¡°íšŒ â†’ JSON ë°ì´í„° ì¶œë ¥

               ![img_4.png](img_4.png)

    2. `docker image history` : ì´ ëª…ë ¹ìœ¼ë¡œ í˜„ì¬ ì´ë¯¸ì§€ êµ¬ì„±ì„ ìœ„í•´ ì‚¬ìš©ëœ ë ˆì´ë¸” ì •ë³´ì™€ ê° ë ˆì´ì–´ì˜ ìˆ˜í–‰ ëª…ë ¹, í¬ê¸° ë“±ì„ ì¡°íšŒ ê°€ëŠ¥

        ```bash
        docker image history [OPTIONS] IMAGE
        ```

       ![img_5.png](img_5.png)

        - CREATED BY: íŠ¹ì • ì´ë¯¸ì§€ë¥¼ êµ¬ì„±í•˜ê¸° ìœ„í•´ ì‚¬ìš©ëœ ëª…ë ¹ê³¼ í™˜ê²½ì„¤ì • ì •ë³´ ë“± í™•ì¸ ê°€ëŠ¥
        - CMD, EXPOSE, ENV, WORKDIR ëª…ë ¹ ë“±ìœ¼ë¡œ ë² ì´ìŠ¤ ì´ë¯¸ì§€ì— í•„ìš”í•œ ì„¤ì • ì •ë³´ë¥¼ ê²°í•©í•´ ìƒˆë¡œìš´ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ê²Œ ëœë‹¤.
- ë„ì»¤ ìœ ë‹ˆì–¸ íŒŒì¼ ì‹œìŠ¤í…œ
  1. ë„ì»¤ ì´ë¯¸ì§€ êµ¬ì¡°ì˜ ê¸°ë³¸ ìš´ì˜ì²´ì œ ë ˆì´ì–´ ìŒ“ê¸°
  2. ìš´ì˜ì²´ì œ ë² ì´ìŠ¤ ì´ë¯¸ì§€ ìœ„ì— ì•„íŒŒì¹˜ ì›¹ ì„œë²„ë¥¼ ì„¤ì¹˜í•œ ë ˆì´ì–´ë¥¼ ì˜¬ë¦°ë‹¤.
  3. ì•„íŒŒì¹˜ ì›¹ì„œë¹„ìŠ¤ì— í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ ì •ë³´ ë° í™˜ê²½ ì •ë³´ê°€ í¬í•¨ëœ ë ˆì´ì–´ë¥¼ ì˜¬ë¦°ë‹¤.
  4. ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰í•˜ë©´ ì—¬ëŸ¬ ê°œì˜ ì»¨í…Œì´ë„ˆë¥¼ êµ¬ë™í•  ìˆ˜ ìˆë‹¤.
- ì™œ ì´ëŸ° êµ¬ì¡° ì‚¬ìš©? â†’ ì¬ì‚¬ìš©ì„±ì„ ë†’ì—¬ì„œ íš¨ìœ¨í™”!

### ë„ì»¤ ì´ë¯¸ì§€ íƒœê·¸ ì„¤ì •ê³¼ ë„ì»¤ ë¡œê·¸ì¸ & ë¡œê·¸ì•„ì›ƒ

- ë„ì»¤ íƒœê·¸: ì›ë³¸ ì´ë¯¸ì§€ì— ì°¸ì¡° ì´ë¯¸ì§€ ì´ë¦„ì„ ë¶™ì´ëŠ” ëª…ë ¹ì–´.
- ì‹¤ìŠµ: ë„ì»¤ í—ˆë¸Œ ì—…ë¡œë“œìš© íƒœê·¸ ì§€ì •: `docker image tag httpd:latest [ë³¸ì¸ ì•„ì´ë””]/httpd:3.0`
![img_6.png](img_6.png)
- ë³¸ì¸ì´ ë² ì´ìŠ¤ ì´ë¯¸ì§€ì— íŠ¹ì • ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì„œë¹„ìŠ¤ì™€ ì½”ë“œ ë“±ì„ í¬í•¨í•´ ì»¨í…Œì´ë„ˆë¡œ ì‹¤í–‰í•œ ê²½ìš°, docker commit ëª…ë ¹ìœ¼ë¡œ ì»¨í…Œì´ë„ˆë¥¼ ì´ë¯¸ì§€ë¡œ ì €ì¥í•  ìˆ˜ ìˆë‹¤.
- ì´ ì´ë¯¸ì§€ë¥¼ ë³¸ì¸ ë„ì»¤ í—ˆë¸Œ ì €ì¥ì†Œì— ì—…ë¡œë“œí•´ ì§€ì†ì ìœ¼ë¡œ í™œìš©í•  ìˆ˜ë„ ìˆê³ , íŒ€ ê°„ ì´ë¯¸ì§€ ê³µìœ ë„ í•  ìˆ˜ ìˆë‹¤.
- ìƒì„±í•œ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ë ¤ë©´ `docker login` ëª…ë ¹ì„ í†µí•´ í˜¸ìŠ¤íŠ¸ì—ì„œì˜ ì ‘ì†ì´ ì´ë¤„ì ¸ì•¼ í•œë‹¤.

## 3.2.2 ë„ì»¤ ì»¨í…Œì´ë„ˆ ëª…ë ¹ì–´

- ì´ë¯¸ì§€ëŠ” ì½ê¸° ì „ìš©ì˜ ë¶ˆë³€ ê°’ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ë‹¤. ì´ëŸ¬í•œ ì´ë¯¸ì§€ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë„ì»¤ ì—”ì§„ì€ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•œë‹¤.
- ë„ì»¤ ì´ë¯¸ì§€ëŠ” ì»¨í…Œì´ë„ˆ ë™ì‘ê³¼ ê´€ë ¨ëœ ì½˜í…ì¸ ë¥¼ ì œê³µí•˜ê³  ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì»¨í…Œì´ë„ˆì˜ ë™ì‘ì´ ì´ë¤„ì§„ë‹¤. ë”°ë¼ì„œ ì»¨í…Œì´ë„ˆ ëª…ë ¹ ëŒ€ë¶€ë¶„ì´ ì„œë¹„ìŠ¤ ì‹¤í–‰ ë° ìš´ì˜ê³¼ ê´€ë ¨

### ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œì„¸ìŠ¤ë‹¤

- ë„ì»¤ ì»¨í…Œì´ë„ˆ: ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì§€ëŠ” ìŠ¤ëƒ…ìƒ·
- ìŠ¤ëƒ…ìƒ·: ì½ê¸° ì „ìš©ì˜ ë„ì»¤ ì´ë¯¸ì§€ ë ˆì´ì–´ë¥¼ ë³µì œí•œ ê²ƒ. ì´ ìœ„ì— ì½ê³  ì“°ê¸°ê°€ ê°€ëŠ¥í•œ ì»¨í…Œì´ë„ˆ ë ˆì´ì–´ë¥¼ ê²°í•©í•˜ë©´ ì»¨í…Œì´ë„ˆê°€ ëœë‹¤.
- ì»´í“¨í„° ì• í”Œë¦¬ì¼€ì´ì…˜ ë™ì‘: í”„ë¡œì„¸ìŠ¤ë¥¼ í†µí•´ ì´ë¤„ì§„ë‹¤.
- ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œì„¸ìŠ¤ ê²©ë¦¬ ê¸°ìˆ ì˜ í‘œì¤€ìœ¼ë¡œ ì •ì˜ëœ OCIë¡œ ì»¨í…Œì´ë„ˆ í¬ë§·ê³¼ ëŸ°íƒ€ì„ì— ëŒ€í•œ ê°œë°©í˜• ì—…ê³„ í‘œì¤€ì„ ë§Œë“¤ê¸° ìœ„í•œ ëª©ì ìœ¼ë¡œ êµ¬ì„±ëœ ì˜¤í”ˆ í”„ë¡œì íŠ¸
- docker runì„ ì‚¬ìš©í•˜ë©´ ì»¨í…Œì´ë„ˆ ë™ì‘ â†’ ê°€ìƒì˜ ê²©ë¦¬ í™˜ê²½ì— ë…ë¦½ëœ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‘

### ì»¨í…Œì´ë„ˆ ì‹¤í–‰: docker run

- ì»¨í…Œì´ë„ˆ ì œì–´ ì‹¤ìŠµ
    - ubuntu 14.04 ë²„ì „ ë‹¤ìš´ë¡œë“œ(`docker pull ubuntu:14.04`)

      ![img_7.png](img_7.png)

    - pullë°›ì€ ubuntuì— ì´ë¦„ ë¶™ì´ê¸°(`docker image tag ubuntu:14.04 container-test1`) â†’ ë”°ë¡œ ë²„ì „ ì§€ì •í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— latest ë²„ì „ìœ¼ë¡œ ìƒì„±

      ![img_8.png](img_8.png)

> docker run = docker [pull] + create + start + [command]

- docker run íŠ¹ì§•:
    - í˜¸ìŠ¤íŠ¸ ì„œë²„ì— ì´ë¯¸ì§€ê°€ ì—†ë”ë¼ë„ ë¡œì»¬ì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ë¥¼ ë„ì»¤ í—ˆë¸Œì—ì„œ ìë™ ë‹¤ìš´ë¡œë“œ(`pull`)
    - ë§ˆì§€ë§‰ì— í•´ë‹¹ ì»¨í…Œì´ë„ˆì— ì‹¤í–‰í•  ëª…ë ¹ ì…ë ¥ ì‹œ ì»¨í…Œì´ë„ˆ ë™ì‘ê³¼ í•¨ê»˜ ì²˜ë¦¬
- **docker runì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” ì˜µì…˜**
    - `-i` : ëŒ€í™”ì‹ ëª¨ë“œ(interactive mode) ì—´ê¸°: Dockerê°€ ì»¨í…Œì´ë„ˆì˜ í‘œì¤€ì…ë ¥ê³¼ ì‚¬ìš©ì í„°ë¯¸ë„ì„ ë¶™ì—¬ì£¼ëŠ”(ì—°ê²°í•´ì£¼ëŠ”) ì˜µì…˜.
        - ì´ê±¸ ì“°ë©´ ìš°ë¦¬ í„°ë¯¸ë„ì—ì„œ ì»¤ë§¨ë“œë¥¼ ì…ë ¥í–ˆì„ ë•Œ í•´ë‹¹ ì»¤ë§¨ë“œë¥¼ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ CLIë¡œ ì „ë‹¬í•´ì£¼ê³  ê±°ê¸°ì„œ ì¶œë ¥ëœ ê²°ê³¼ë¬¼ì„ ìš°ë¦¬ í„°ë¯¸ë„ë¡œ ë„ì§‘ì–´ë‚´ì„œ ë³´ì—¬ì¤€ë‹¤.
        - í•˜ì§€ë§Œ `-i` ì˜µì…˜ë§Œ ì“°ê²Œ ë˜ë©´ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì…¸ê³¼ëŠ” ìƒí˜¸ì‘ìš©í•  ìˆ˜ ì—†ìŒ.
       ![img_9.png](img_9.png)
      - ìš°ë¦¬ê°€ ì¸í’‹ì€ ë„£ê³  ì‹¶ì€ë° í•´ë‹¹ ì…¸ í”„ë¡¬í”„íŠ¸ì˜ ì•„ì›ƒí’‹ì„ ë³´ê³  ì‹¶ì§€ëŠ” ì•Šì„ ë•Œ ì´ê²ƒì„ ì“°ë©´ ëœë‹¤.
    - `-t` : tty(ì»¨í…Œì´ë„ˆ ë‚´ë¶€ í„°ë¯¸ë„ì„ ëœ»í•¨)
        - t ì˜µì…˜ë§Œ ì“°ë©´ í•´ë‹¹ ì»¨í…Œì´ë„ˆì— í„°ë¯¸ë„ì„ í• ë‹¹í•´ì£¼ì§€ë§Œ ìš°ë¦¬ í„°ë¯¸ë„ê³¼ ì»¨í…Œì´ë„ˆì˜ í‘œì¤€ ì…ë ¥ ì‚¬ì´ê°€ ë¶™ì–´ìˆì§€ ì•ŠìŒ. ì¦‰, í•´ë‹¹ ì»¨í…Œì´ë„ˆì˜ ì»¤ë§¨ë“œ ë¼ì¸ê³¼ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ì—†ìŒ.
        - ì¦‰, í„°ë¯¸ë„ì€ ë–  ìˆì§€ë§Œ, í•´ë‹¹ í„°ë¯¸ë„ì„ í†µí•´ ëª…ë ¹ì–´ë¥¼ ì „ë‹¬í•  ìˆ˜ë„ ì—†ê³  ë§ˆì°¬ê°€ì§€ë¡œ ì–´ë–¤ ê²°ê³¼ë¬¼ë„ í™•ì¸í•  ìˆ˜ ì—†ë‹¤.
        - ![img_10.png](img_10.png)
    - `-it`: í•´ë‹¹ ì»¨í…Œì´ë„ˆì— í„°ë¯¸ë„ì„ í• ë‹¹í•˜ê³  & ìš°ë¦¬ í„°ë¯¸ë„ê³¼ ê·¸ìª½ í„°ë¯¸ë„ ì‚¬ì´ë¥¼ ì—°ê²°(attach)í•¨ìœ¼ë¡œì¨ ëª…ë ¹ì–´ ì „ë‹¬ ë° ì•„ì›ƒí’‹ ì¶œë ¥ ê°€ëŠ¥
        ![img_11.png](img_11.png)
    - `-d` : ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ í›„ ì»¨í…Œì´ë„ˆ id ë“±ë¡
      - ì¼ë°˜ì ìœ¼ë¡œ docker runì— ëª…ë ¹ì–´ ë”°ë¡œ ë¶™ì´ì§€ ì•Šê³  -d ì˜µì…˜ë§Œ ë¶™ì´ë©´ ì‹¤í–‰í•  ê²Œ ì—†ì–´ì„œ í•´ë‹¹ í”„ë¡œê·¸ë¨ ì¢…ë£Œëœë‹¤.
      - `docker run -d --name=python_test -p 8900:8900 python` ì´í›„ `docker ps` ë¡œ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸ â†’ python ì¢…ë£Œë˜ì–´ ìˆìŒ
      ![img_12.png](img_12.png)
    - `-itd` : container ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•œ ë’¤ í‘œì¤€ ì…ë ¥ ëª…ë ¹ ìˆ˜í–‰ â†’ input ë°›ì„ ìˆ˜ ìˆëŠ” ìƒíƒœë¡œ ê³„ì† ëŒ€ê¸°(ì»¨í…Œì´ë„ˆ ì¢…ë£Œë˜ì§€ ì•ŠìŒ)
      ![img_13.png](img_13.png)
      ![img_14.png](img_14.png)

### ì‹¤ìŠµ 3-1: SQL í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ê°œë°œ íŒ€ì˜ ë°ì´í„°ë² ì´ìŠ¤ ìš”ì²­ìœ¼ë¡œ MySQL 5.7 ì»¨í…Œì´ë„ˆ ì‹¤í–‰

- 1. `docker pull --platform linux/amd64 mysql:5.7`
    - ì–´ë¼? ê·¼ë° ìš°ë¦¬ëŠ” ë§¥ë¶ ì“°ê³  ìˆìœ¼ë‹ˆê¹Œ arm64 ë²„ì „ìœ¼ë¡œ ë°›ì•„ì•¼ í•˜ëŠ” ê±° ì•„ë‹˜?
        1. arm64ìš© 5.7ë²„ì „ì´ ì—†ë‹¤â€¦ â†’ [ë„ì»¤ í—ˆë¸Œ ë‚´ official imageì—ëŠ” 8ë²„ì „ë§Œ ì¡´ì¬](https://hub.docker.com/_/mysql)
        2. í•˜ì§€ë§Œ ìš°ë¦¬ì—ê²ŒëŠ” QEMUê°€ ìˆë‹¤! â†’ [ê³µì‹ ë¬¸ì„œ ì°¸ì¡°](https://www.notion.so/Ch-3-fec8591268d340519b152d095068fbe2)

           You can build multi-platform images using three different strategies that are supported by Buildx and Dockerfiles:

            1. **Using the QEMU emulation support in the kernel(Docker desktopì„ ì“¸ ê²½ìš° ì—¬ê¸°ì— í•´ë‹¹)**
            2. Building on multiple native nodes using the same builder instance
            3. Using a stage in Dockerfile to cross-compile to different architectures

        >        ğŸ’¡ When you run a container with the **`linux/amd64`** platform on an Apple M1 silicon mac, the Docker engine uses a technology called "Emulation" to translate the x86_64 instructions (used by the **`linux/amd64`** platform) to the ARM64 instructions (used by the Apple M1 silicon mac).
        >
        >      Docker Desktop for Mac, which is the version of Docker that runs on Apple M1 silicon macs, includes an emulation layer called "QEMU" that allows you to run containers built for the **`linux/amd64`** platform on an Apple M1 silicon mac. This emulation layer works by translating the x86_64 instructions to ARM64 instructions in real-time.
        >
        >      This emulation layer adds some overhead and can result in slower performance compared to running native ARM64 containers. However, for many applications, the performance impact is minimal and the benefits of running containers in a consistent environment across different platforms outweigh the performance cost.
        >
        >      To run a container with the **`linux/amd64`** platform on an Apple M1 silicon mac, you can use the **`--platform`** flag with the **`docker run`** command. For example, to run the **`hello-world`** image with the **`linux/amd64`** platform, you can run:
        >
        >        ```
        >        docker run --platform linux/amd64 hello-world
        >        ```
        >
        >      This will pull the **`hello-world`** image with the **`linux/amd64`** platform and run it on your Apple M1 silicon mac using QEMU emulation.
        >
        >      Note that not all images may work with emulation, as some images may have dependencies that are only available for a specific platform. It's always a good idea to check the compatibility of an image before running it on a different platform.

2. ì´ë¯¸ì§€ ì¡°íšŒ: `docker images | grep mysql`
   ![img_15.png](img_15.png)
3. ì»¨í…Œì´ë„ˆ ì‹¤í–‰: ì´ë¦„ ë”°ë¡œ ì§€ì •í•´ì„œ run
    - `docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:5.7`
      - ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì ‘ì† í›„ `/etc/init.d/mysql start` â†’ ë ˆê±°ì‹œ ë°©ì‹! ë”°ë¼ì„œ ìœ„ì™€ ê°™ì´ ì ‘ì† í›„ exec ëª…ë ¹ì–´ë¡œ ë‚´ë¶€ë¡œ ì§„ì…í•œë‹¤.
4. ì»¨í…Œì´ë„ˆ OS í™•ì¸: docker exec ëª…ë ¹ì–´ë¡œ ë‚´ë¶€ ì ‘ê·¼
   - `docker exec -it {container ID} bash` ëª…ë ¹ì–´ë¥¼ í†µí•´ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ë¡œ ì ‘ê·¼
   - `cat /etc/os-release` ëª…ë ¹ì–´ë¡œ OS í™•ì¸
   ![img_16.png](img_16.png)
   - `mysql -u root -p`: MySQL ì‹¤í–‰í•˜ê¸°
   - ì»¨í…Œì´ë„ˆ ì¢…ë£Œí•˜ì§€ ì•Šê³  í„°ë¯¸ë„ ë¹ ì ¸ ë‚˜ì˜¤ë ¤ë©´ ctrl ëˆ„ë¥¸ ìƒíƒœë¡œ P ëˆ„ë¥´ê³  Q ëˆ„ë¥´ê¸°
5. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ IP í™•ì¸: `docker inspect some-mysql | grep IPAddress`
   ![img_17.png](img_17.png)

### ì‹¤ìŠµ 3-2: ì»¨í…Œì´ë„ˆ ëª¨ë‹ˆí„°ë§ ë„êµ¬ cAdvisor ì»¨í…Œì´ë„ˆ ì‹¤í–‰

- ì„œë¹„ìŠ¤ ìš´ì˜ í•˜ë©´ì„œ í•„ìš”í•œ ì‹œìŠ¤í…œ Metric(CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ , ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ë“±)ì„ ëª¨ë‹ˆí„°ë§í•˜ë©´ì„œ íŠ¹ì´ì‚¬í•­ì´ ìˆì„ ë•Œ ëŒ€ì‘í•˜ê¸° ìœ„í•´ ëª¨ë‹ˆí„°ë§ ìˆ˜í–‰
- ê·¸ëŸ¬ë‚˜ ì»¨í…Œì´ë„ˆë¼ëŠ” í™˜ê²½ í•˜ì—ì„œëŠ” ê¸°ì¡´ ëª¨ë‹ˆí„°ë§ ë„êµ¬ë¡œëŠ” container ëª¨ë‹ˆí„°ë§ ì§„í–‰ì´ ì–´ë µë‹¤
- ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²°í•˜ê³  ì»¨í…Œì´ë„ˆë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•œ ë„êµ¬ë¡œ êµ¬ê¸€ì—ì„œ ì œê³µí•˜ëŠ” cAdvisor(Container Advisor)ë¥¼ ë§ì´ ì‚¬ìš©í•¨
> ì£¼ì˜: ê¸°ì¡´ google/cadvisorë¡œëŠ” docker ì‹¤í–‰ì— ì—ëŸ¬ ë°œìƒ!
> â†’ ë²„ì „(latest â†’ 0.46.0) &ì´ë¯¸ì§€ ì´ë¦„(google â†’ gcr.io) ë³€ê²½í•´ì•¼ ëœë‹¤. 
> ref([link](https://github.com/google/cadvisor/issues/3073))

```bash
docker run \
> --volume=/:/rootfs:ro \
> --volume=/var/run:/var/run:rw \
> --volume=/sys:/sys:ro \
> --volume=/var/lib/docker/:/var/lib/docker:ro \
> --publish=9559:8080 \
> --detach=true \
> --name=cadvisor \
> gcr.io/cadvisor:v0.46.0
```

- `http://localhost:9559/` ì ‘ì†
- ![img_18.png](img_18.png)
- ì•„ë¬´ ì´ë¯¸ì§€ë‚˜ runí•œ ë’¤ (ex - nginx) ì‚¬ì´íŠ¸ ì•„ë˜ ì­‰ ë‚´ë ¤ê°€ë©´ /docker ë³´ì´ëŠ”ë° í´ë¦­
- ![img_19.png](img_19.png)
- ê·¸ëŸ¬ë©´ í•´ë‹¹ ì»¨í…Œì´ë„ˆ id  & CPU ì‚¬ìš©ëŸ‰ ë“± í™•ì¸ ê°€ëŠ¥
- ![img_20.png](img_20.png)

### 3-3 ì›¹ì„œë¹„ìŠ¤ ì‹¤í–‰ì„ ìœ„í•œ nginx ì»¨í…Œì´ë„ˆ ì‹¤í–‰

- `docker pull nginx:1.18`
- `docker images` â†’ nginx ì´ë¯¸ì§€ í™•ì¸
- `docker run â€”name webserver1 -d -p 8001:80 nginx:1.18`
    - â€”name: ì»¨í…Œì´ë„ˆ ì´ë¦„ ì§€ì •
    - -d: ì»¨í…Œì´ë„ˆë¥¼ ë°±ê·¸ë¼ìš´ë“¤ì—ì„œ ì‹¤í–‰í•˜ê³  ì»¨í…Œì´ë„ˆ idë¥¼ ì¶œë ¥
    - -p: ì»¨í…Œì´ë„ˆì˜ 80ë²ˆ í¬íŠ¸ë¥¼ host í¬íŠ¸ 8001ë¡œ ì˜¤í”ˆ
        - ì• ë²ˆí˜¸: í˜¸ìŠ¤íŠ¸ í¬íŠ¸
        - ë’· ë²ˆí˜¸: ë‚´ë¶€ ì»¨í…Œì´ë„ˆ í¬íŠ¸
- `sudo lsof -i :8001` : í˜„ì¬ 8001ë²ˆ í¬íŠ¸ ìƒíƒœ í™•ì¸(PID, User, â€¦) 
  ![img_21.png](img_21.png)
- localhost:8001 ì ‘ì†
  ![img_22.png](img_22.png)
- `docker stats webserver1`: ì»¨í…Œì´ë„ˆì˜ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì‹¤ì‹œê°„ í™•ì¸
  ![img_23.png](img_23.png)
- `docker logs -f webserver1` : nginx ì»¨í…Œì´ë„ˆ ì ‘ê·¼ ë¡œê·¸ í™•ì¸
    ![img_24.png](img_24.png)
  - ë¡œê·¸ ì¼  ìƒíƒœë¡œ nginx í˜ì´ì§€ ì ‘ì†í•´ì„œ ìƒˆë¡œê³ ì¹¨ â†’ 
- `curl localhost:8001`: í”„ë¡œí† ì½œë“¤ì„ ì´ìš©í•´ URL ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ì—¬ ì„œë²„ì— ë°ì´í„°ë¥¼ ë³´ë‚´ê±°ë‚˜ ê°€ì ¸ì˜¬ë•Œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ CLI ë„êµ¬
```html
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
BH-L168:~ woony.kim$ docker stop webserver1
webserver1
BH-L168:~ woony.kim$ docker start webserver1
webserver1
BH-L168:~ woony.kim$ curl localhost:8001
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
```
- `vi index.html`: index íŒŒì¼ ìƒˆë¡œ ìƒì„±
```shell
# index.html
<h1> Hello, Jpub Docker. </h1>
```
- docker ì»¨í…Œì´ë„ˆ ë‚´ë¶€ë¡œ  index.html íŒŒì¼ ì´ë™: `docker cp index.html webserver1:/usr/share/nginx/html/index.html`
- ì‚¬ì´íŠ¸ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ë³€ê²½ëœ ê²ƒì„ í™•ì¸ ê°€ëŠ¥
    ![img_25.png](img_25.png)
- `docker restart` : ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ - ê¸°ì¡´ ì»¨í…Œì´ë„ˆ í”„ë¡œì„¸ìŠ¤ë¥¼ ì •ì§€í•˜ê³  ìƒˆ ì»¨í…Œì´ë„ˆ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹œì‘. ë”°ë¼ì„œ ì»¨í…Œì´ë„ˆ ë™ì‘ì—ëŠ” ì˜í–¥ì„ ì£¼ì§€ ì•Šê³  í˜¸ìŠ¤íŠ¸ì˜ PIDë§Œ ë³€ê²½ëœë‹¤.
### ì‹¤ìŠµ 3-4: íŒŒì´ì¬ í”„ë¡œê·¸ë˜ë° í™˜ê²½ì„ ì»¨í…Œì´ë„ˆë¡œ ì œê³µ

- ìƒ˜í”Œ ì½”ë“œ ì‘ì„±

```python
from random import shuffle
from time import sleep

gamenum = input('ë¡œë˜ ê²Œì„ íšŸìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”: ')
for i in range(int(gamenum)):
    balls = [x+1 for x in range(45)]
    ret = []
    for j in range(6):
        shuffle(balls)       # ballsë¥¼ ë¬´ì‘ìœ„ë¡œ ì„ê³ 
        number = balls.pop() # ballsì˜ ê°€ì¥ ë§ˆì§€ë§‰ ìˆ«ìë¥¼ ì¶”ì¶œí•œ ë’¤ ì œê±°
        ret.append(number)   # ì¶”ì¶œëœ ìˆ«ìë¥¼ retì— ì¶”ê°€
    ret.sort()
    print('ë¡œë˜ë²ˆí˜¸[%d]: ' %(i+1), end='')
    print(ret)
    sleep(1)
```

- íŒŒì´ì¬ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ í›„ py_lotto.py ìƒ˜í”Œ ì½”ë“œ ë³µì‚¬
    - `docker run -itd â€”name=python_test -p 8900:8900 python`
        - (ë³µìŠµ) -d ì˜µì…˜: ì»¨í…Œì´ë„ˆë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•˜ê³  ì»¨í…Œì´ë„ˆ idë¥¼ ì¶œë ¥

          ![img_26.png](img_26.png)

    - `docker cp py_lotto.py python_test:/` : ì‘ì„±í•œ py íŒŒì¼ì„ ë„ì»¤ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ë¡œ ì „ë‹¬
- ì»¨í…Œì´ë„ˆ í™•ì¸: `docker exec -it python_test bash`
- ì™¸ë¶€ì—ì„œ íŒŒì´ì¬ ì»¨í…Œì´ë„ˆ ì½”ë“œ ì‹¤í–‰
    - exec: ë„ì»¤ ì»¨í…Œì´ë„ˆì— ëª…ë ¹ ì „ë‹¬(running ìƒíƒœì¸ ì»¨í…Œì´ë„ˆì—ì„œë§Œ ê°€ëŠ¥í•œ ëª…ë ¹ì–´)

  ![img_27.png](img_27.png)
- *ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì— ì†ŒìŠ¤ ì½”ë“œ, êµ¬ì„± ì •ë³´(.conf) ë“±ì„ ë³€ê²½í•˜ëŠ” ê²½ìš° `docker cp(COPY)` ëª…ë ¹ì–´ê°€ ìœ ìš©í•˜ë‹¤. (ë’¤ì— Dockerfile ëª…ë ¹ì–´ ê´€ë ¨í•´ì„œ ë°°ìš¸ ì˜ˆì •)
- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ íŒŒì¼ì„ ìˆ˜ì •í•´ì•¼ í•œë‹¤ë©´ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì— í¸ì§‘ê¸°ë¥¼ ì„¤ì¹˜í•˜ê±°ë‚˜ í•  í•„ìš”ê°€ ì—†ìŒ.

### ì‹¤ìŠµ 3-5. node.js í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ìœ„í•œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰

- vi nodejs_test.js

    ```python
    const http = require('http');
    const content = function(req, resp) {
      resp.end("Good morning Korea~!" + "\n");
      resp.writeHead(200);
    }
    const web = http.createServer(content);
    web.listen(8002);
    ```

- `node nodejs_test.js` : fail
    ![img_28.png](img_28.png)
- `docker pull node`
- `docker cp nodejs_test.js nodejs_test:/nodejs_test.js`
- `docker exec -it nodejs_test node /nodejs_test.js`
    ![img_29.png](img_29.png)
![img_30.png](img_30.png)

- `docker rename`: ì»¨í…Œì´ë„ˆ ì´ë¦„ ë³€ê²½í•˜ê³  ì‹¶ì„ ë•Œ
![img_31.png](img_31.png)

- `docker commit`: ì•ì—ì„œ ìƒì„±í•œ ì»¨í…Œì´ë„ˆ ë…¸ë“œ í”„ë¡œê·¸ë¨ í™˜ê²½ê³¼ ì €ì¥í•œ ì†ŒìŠ¤ì½”ë“œ ê·¸ëŒ€ë¡œ ìƒˆë¡œìš´ ì´ë¯¸ì§€ ìƒì„±
- `curl localhost:8008`
    - code

        ```html
        <!DOCTYPE html>
        <html>
        <head>
        <title>Welcome to nginx!</title>
        <style>
        html { color-scheme: light dark; }
        body { width: 35em; margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif; }
        </style>
        </head>
        <body>
        <h1>Welcome to nginx!</h1>
        <p>If you see this page, the nginx web server is successfully installed and
        working. Further configuration is required.</p>
        
        <p>For online documentation and support please refer to
        <a href="http://nginx.org/">nginx.org</a>.<br/>
        Commercial support is available at
        <a href="http://nginx.com/">nginx.com</a>.</p>
        
        <p><em>Thank you for using nginx.</em></p>
        </body>
        </html>
        ```

- `docker cp index.html webserver8:/usr/share/nginx/html/index.html`
    - ê¸°ì¡´ì— ë§Œë“¤ì–´ë’€ë˜ `index.html` ì„ ì˜®ê¸´ë‹¤.
- `docker diff webserver8`: ë³€ê²½ ì†ŒìŠ¤ í™•ì¸
    - index.html ë³€ê²½ëœ ê²ƒì„ í™•ì¸ ê°€ëŠ¥

      ![img_32.png](img_32.png)
- `docker commit -a "jpub" webserver8 webfront:1.0`
  - docker commitìœ¼ë¡œ ì´ë¯¸ì§€ ìƒì„± (-a: ìƒì„±ì ì´ë‹ˆì…œ)

    ![img_33.png](img_33.png)

- docker login í›„ ì´ë¯¸ì§€ push
    - `docker login`
    - docker tag webfront:1.0 [ë³¸ì¸ID]/webfront:1.0
    - docker push [ë³¸ì¸ID]/webfront:1.0

  ![img_34.png](img_34.png)

    - í‘¸ì‹œí•œ ì´ë¯¸ì§€ ë‚´ë ¤ë°›ì•„ì„œ ì»¨í…Œì´ë„ˆë¡œ ì˜ ë™ì‘í•˜ëŠ”ì§€ ì²´í¬

  ![img_35.png](img_35.png)

    - [hub.docker.com](http://hub.docker.com) ì‚¬ì´íŠ¸ í™•ì¸

  ![img_36.png](img_36.png)

## 3.2.3 ë„ì»¤ ë³¼ë¥¨ í™œìš©


> ğŸ’¡ Docker Volumes are the preferred mechanism for persisting data generated by and used by Docker containers([docs](https://docs.docker.com/storage/volumes/)).
> 
> `ë„ì»¤ ë³¼ë¥¨ì€ ë„ì»¤ ì»¨í…Œì´ë„ˆë¡œë¶€í„° ìƒì„±ë˜ê±°ë‚˜ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ë¥¼ ì˜ì†í™”í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì´ë‹¤.`


[Manage data in Docker(link)](https://docs.docker.com/storage/)

![img_37.png](img_37.png)

- ë„ì»¤ëŠ” ìœ ë‹ˆì–¸ íŒŒì¼ ì‹œìŠ¤í…œ ì‚¬ìš©
    - í•˜ë‚˜ì˜ ì´ë¯¸ì§€ë¡œë¶€í„° ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì œê³µ & ì´ë¯¸ì§€ì— ë³€ê²½ ë‚´ìš© ì €ì¥

**ë„ì»¤ ë³¼ë¥¨**: ë°ì´í„°ë² ì´ìŠ¤, ì›¹ í”„ë¡œê·¸ë¨ ë“± ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°œìƒí•˜ëŠ” ë°ì´í„°ì— ì ‘ê·¼ & ê³µìœ í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©

- ë„ì»¤ ë³¼ë¥¨ì€ ì»¨í…Œì´ë„ˆì—ì„œ ìƒì„± & ì¬ì‚¬ìš© â†’ í˜¸ìŠ¤íŠ¸ ìš´ì˜ì²´ì œì—ì„œ ì§ì ‘ ì ‘ê·¼ ê°€ëŠ¥
- ë³´ì¡´ë˜ì–´ì•¼ í•˜ëŠ” ë°ì´í„°ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•œ ë©”ì»¤ë‹ˆì¦˜ ì œê³µ
    - ì¼ë°˜ì ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ë°ì´í„°ëŠ” ì»¨í…Œì´ë„ˆì˜ ë¼ì´í”„ì‚¬ì´í´ê³¼ ì—°ê´€ë˜ì–´ ì»¨í…Œì´ë„ˆ ì¢…ë£Œ ì‹œ ì‚­ì œ
    - ì´ë¥¼ ì˜ì†í™”í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë„ì»¤ ë³¼ë¥¨ ì‚¬ìš© ì‹œ ì»¨í…Œì´ë„ˆê°€ ì‚­ì œë˜ë”ë¼ë„ ë³¼ë¥¨ì€ ë…ë¦½ì ìœ¼ë¡œ ìš´ì˜ë˜ê¸° ë•Œë¬¸ì— ì‚­ì œë˜ì§€ ì•ŠëŠ”ë‹¤!

### ë„ì»¤ ë³¼ë¥¨ íƒ€ì…

![img_38.png](img_38.png)

1. Volume: í˜¸ìŠ¤íŠ¸ íŒŒì¼ ì‹œìŠ¤í…œì˜ ì¼ë¶€ ì¤‘ ë„ì»¤ê°€ ê´€ë¦¬í•˜ëŠ” ì˜ì—­`(/var/lib/docker/volumes/ on Linux -> ë„ì»¤ ë°ìŠ¤í¬íƒ‘ì—ì„œ ê°€ìƒí™”ëœ!)`ì— ì €ì¥í•¨. ë„ì»¤ê°€ ì•„ë‹Œ í”„ë¡œì„¸ìŠ¤ëŠ” í•´ë‹¹ íŒŒì¼ ì‹œìŠ¤í…œì— ì ‘ê·¼ ë¶ˆê°€. **ë„ì»¤ ë³¼ë¥¨ì€ ê³µì‹ ë¬¸ì„œ ì™ˆ ë„ì»¤ì—ì„œ ë°ì´í„°ë¥¼ ì˜ì†í™”í•˜ëŠ” ê°€ì¥ ìµœê³ ì˜ ë°©ë²•!**
2. Bind mounts: í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œ ì–´ë””ì—ë‚˜ ì €ì¥ ê°€ëŠ¥. ì‹¬ì§€ì–´ ì£¼ìš” ì‹œìŠ¤í…œ íŒŒì¼ì´ë‚˜ ë””ë ‰í† ë¦¬ê°€ ë  ìˆ˜ë„ ìˆë‹¤. ë„ì»¤ê°€ ì•„ë‹Œ í”„ë¡œì„¸ìŠ¤ê°€ í•´ë‹¹ íŒŒì¼ / ë””ë ‰í† ë¦¬ë¥¼ ì–¸ì œë“  ë³€ê²½ ê°€ëŠ¥
3. `tmpfs` mounts: í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì˜ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ë©° íŒŒì¼ ì‹œìŠ¤í…œì—ëŠ” ì ˆëŒ€ ì €ì¥í•˜ì§€ ì•ŠìŒ.

1.  **Volume(**Bind mount, tmpfs mountëŠ” ë”°ë¡œ ë³´ê¸°**)**
    1. ë„ì»¤ì—ì„œ ê¶Œì¥í•˜ëŠ” ë°©ë²• â†’ `docker volume create [ë³¼ë¥¨ ì´ë¦„]` ì„ í†µí•´ ë³¼ë¥¨ ìƒì„±
    2. ë„ì»¤ ë³¼ë¥¨: ë„ì»¤ ëª…ë ¹ì–´ë¡œ ê´€ë¦¬
    3. ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ ê°„ì— ì•ˆì „í•˜ê²Œ ê³µìœ 
    4. ë³¼ë¥¨ ë“œë¼ì´ë²„ë¡œ ì›ê²© í˜¸ìŠ¤íŠ¸ ë° í´ë¼ìš°ë“œ í™˜ê²½ì— ë³¼ë¥¨ ë‚´ìš© ì €ì¥ ë° ì•”í˜¸í™”
    5. ìƒˆ ë³¼ë¥¨ìœ¼ë¡œ ì§€ì •ë  ì˜ì—­ì— ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ì±„ìš°ê³  ì»¨í…Œì´ë„ˆ ì—°ê²°í•˜ë©´ ë°”ë¡œ ë°ì´í„° ì‚¬ìš© ê°€ëŠ¥
- docker ë³¼ë¥¨ ìƒì„± ì‹¤ìŠµ
    - `docker volume create my-appvol-1`
    - `docker volume ls`
    - `docker volume inspect my-appvol-1`

    ```bash
    docker run -d --name vol-test1 \
    --mount source=my-appvol-1,target=/app \
    ubuntu:20.04
    ```
![img_39.png](img_39.png)

- `docker volume create`ë¥¼ í•˜ì§€ ì•Šë”ë¼ë„ `docker ru`ní•  ë•Œ ë³¼ë¥¨ ì´ë¦„ì„ ì“°ë©´ ìë™ìœ¼ë¡œ ìƒì„±ëœë‹¤ â†’ `docker inspect`ì—ì„œ `my-appvol-2`ê°€ ìë™ ìƒì„±ëœ ê²ƒì„ í™•ì¸

![img_40.png](img_40.png)

- docker volume ì§€ìš°ê¸°: `docker volume rm [ë³¼ë¥¨ ì´ë¦„]`
    - ë³¼ë¥¨ì´ ì•ˆ ì§€ì›Œì§„ë‹¤?!
        - `Error response from daemon: remove my-appvol-2: volume is in use - [df8f1d056a1f89fe21395481fb303b47ebab05fd5745a5fce6300da30fc4b601, 18903a7f47908b4d009dc71c091a1847f646be08407bb677e5a66054c08412a1]`
        - ë§Œì•½ ì»¨í…Œì´ë„ˆê°€ í•´ë‹¹ ë³¼ë¥¨ì„ ì‚¬ìš©í–ˆë‹¤ë©´ í•´ë‹¹ ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš© ì¤‘ì´ì§€ ì•Šë”ë¼ë„ ë³¼ë¥¨ì„ ì§€ìš¸ ìˆ˜ ì—†ê²Œë” ë˜ì–´ ìˆë‹¤.
        - ì´ëŸ´ ë•ŒëŠ” `docker ps -a`ë¡œ ì¢…ë£Œëœ ì»¨í…Œì´ë„ˆê¹Œì§€ ì‹¹ë‹¤ í™•ì¸í•œ ë‹¤ìŒ í•´ë‹¹ ë³¼ë¥¨ì„ ì‚¬ìš©í•˜ê³  ìˆëŠ” ì»¨í…Œì´ë„ˆ IDë¥¼ í™•ì¸í•´ì„œ ì‚­ì œí•œë‹¤.

          ![img_41.png](img_41.png)

### ì‹¤ìŠµ 3-6: ë°ì´í„°ë² ì´ìŠ¤ì˜ ë°ì´í„° ì§€ì†ì„± ìœ ì§€

- ë°ì´í„°ë² ì´ìŠ¤ ì»¨í…Œì´ë„ˆì˜ ë°ì´í„° ë³´í˜¸ë¥¼ ìœ„í•´ ë³¼ë¥¨ ì§€ì • ê°€ëŠ¥.
- ë§Œì•½ ì»¨í…Œì´ë„ˆì˜ ì¥ì• ë¡œ ì¸í•´ ì„œë¹„ìŠ¤ê°€ ì¤‘ë‹¨ë˜ì–´ë„ ìƒˆë¡œìš´ ì»¨í…Œì´ë„ˆì— ë™ì¼ ë³¼ë¥¨ì„ ì—°ê²°í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì˜ DB, Table, Data ëª¨ë‘ ë™ì¼í•˜ê²Œ ì§€ì† ê°€ëŠ¥
- `docker run --name mysql-test -e MYSQL_ROOT_PASSWORD=1234 -e MYSQL_DATABASE=dockertest -v mysql-data-vol:/var/lib/mysql -d mysql:5.7`